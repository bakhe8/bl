# وثيقة تدفق معالجة Excel — أولوية 4/5

## ما يحدث بعد رفع الملف
1) التحقق من الامتداد والصلاحية.
2) قراءة الملف عبر SheetJS وتحويله إلى JSON داخلي.
3) اكتشاف الأعمدة وتطبيق column mapping قابل للحفظ إلى الحقول القياسية (bank, supplier, guarantee_no, contract_no, amount, date).
4) تنظيف القيم وتطبيعها (حروف، فراغات، رموز).

## شكل التحويل لكل سطر (مثال)
```json
{
  "bank_raw": "...",
  "supplier_raw": "...",
  "guarantee_no": "...",
  "contract_no": "...",
  "amount_raw": "...",
  "renewal_date_raw": "..."
}
```

## التنبيهات المحتملة
- أعمدة مفقودة أو غير معروفة.
- صفوف ناقصة حقول رئيسية.
- تواريخ أو أرقام غير قابلة للقراءة.

## أخطاء الاستيراد ومعالجتها
- ملف غير مدعوم: إظهار رسالة واضحة ورفض التحميل.
- أعمدة غير مكتشفة: طلب تأكيد/تعيين يدوي للأعمدة مع حفظ الاختيار.
- بيانات غير صالحة: وضع الصفوف في قائمة مراجعة لإصلاحها أو استبعادها.

## المخرجات
- JSON موحّد يُمرَّر إلى خوارزميات التطابق والبناء اللاحق للخطاب.
