# Design Decisions v1.0 (Final Pre-Code)

## سياسة إضافة مورد جديد (Supplier Creation)
- المورد الجديد لا يُضاف تلقائياً، بل في حالتين: (1) إدخال يدوي من المستخدم، أو (2) وجوده ضمن خطاب سبق اعتماده.
- أي مورد غير مألوف من Excel يُعرض للمستخدم لاتخاذ القرار.

## سياسة التعلم ومنع التعلّم الخاطئ (Learning Safety)
- أي variant جديد يجب أن يرتبط بصف Excel سليم 100%.
- variant يظهر مرة واحدة فقط → غير مؤكد. يظهر في 3 ملفات Excel مختلفة → يصبح مؤكداً.
- إذا كان variant مشابهًا لاسم رسمي بنسبة > 90% يجب إظهار تحذير للمستخدم.
- النظام لا يضيف اختصارات تلقائياً إلى القاموس.

## سياسة مراجعة البيانات (Review Workflow)
- لا توجد شاشة مراجعة إضافية قبل الطباعة؛ المستخدم مسؤول عن المراجعة عند فتح الخطاب للطباعة.

## سياسة تنسيق المبلغ (Amount Formatting)
- لا تحويل للمبالغ إلى نص، المخرج رقمي بصيغة عربية-هندية مع فواصل: **٩٩٩٬٩٩٩٫٩٩ ريال**.

## سياسة أسماء البنوك الإنجليزية (Bank Name Matching)
- القاموس الرسمي للبنوك بالعربية فقط.
- أي اسم بنك إنجليزي (ANB، SNB، RIB...) لا يطابق تلقائياً؛ يعرض للمستخدم لاختيار البنك الصحيح.
- لا تُضاف اختصارات إنجليزية إلى القاموس الرسمي.

## سياسة الترميز (Encoding)
- يقبل النظام ملفات UTF-8 فقط. أي ملف يظهر فيه "؟؟؟" يُرفض مباشرة مع رسالة:
  - "تعذّر قراءة الملف: صيغة الترميز غير معتمدة (UTF-8 فقط)."

## سياسة التاريخ (Date Handling)
- يدعم جميع صيغ التواريخ في الإدخال؛ المخرج دائماً بصيغة عربية موحدة: **01 يناير 2025م**.

## سياسة التراجع (Undo)
- لا يوجد زر تراجع؛ القرارات تُحفظ فوراً. عند تسجيل variant جديد يُعرض تحذير.

## سياسة فقدان بيانات LocalStorage
- الاعتماد الكامل على LocalStorage للقواميس والتعلم. حذف بيانات المتصفح يعني البدء من الصفر.
- لا يوجد Auto-Backup أو استرداد تلقائي. تحذير للمستخدم يُعرض مرة واحدة.

## سياسة لغة البيانات داخل Excel
- النظام يتعامل مع خليط عربي/إنجليزي في الإدخال، لكن المخرجات النهائية دائماً بالعربية. الـ Matching يتعامل مع EN→AR بحذر دون استنتاجات غير موثوقة.
