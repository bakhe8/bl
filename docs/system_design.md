# وثيقة تصميم النظام — أولوية 5/5

## بنية المشروع (Folders / Files)
- صفحة HTML رئيسية (واجهة التحميل، القرارات، والمعاينة).
- ملفات JS (محول Excel، معالج البيانات، القواميس، مولّد الخطاب).
- ملفات JSON للقواميس (تصدير/استيراد).
- دليل `docs/` للوثائق.

## الموديولات الرئيسية
- **Excel Adapter**: قراءة الملف باستخدام SheetJS وتحويله إلى JSON موحّد.
- **Data Cleaner**: تنقية الحقول (أسماء، مبالغ، تواريخ) وتوحيدها.
- **Dictionary Engine**: إدارة القواميس الرسمية والتعلمية والـ variants.
- **Matcher**: تطبيق خوارزميات التطابق متعددة الطبقات مع حفظ القرارات.
- **Letter Builder**: توليد الخطاب باللغة العربية (RTL) مع placeholders واضحة.
- **UI Flow Controller**: إدارة التنقل بين رفع الملف، القرارات، ومعاينة/طباعة الخطاب.

## تدفق البيانات (Data Flow)
1) رفع ملف Excel.
2) التحويل إلى JSON داخلي.
3) تنظيف الحقول وتوحيدها.
4) تطابق مع القواميس وتحديد الحالات الغامضة.
5) قرارات المستخدم تُحفظ كـ variants وتُحدّث القواميس.
6) توليد الخطاب بقالب ثابت وجاهز للطباعة.

## تدفق الواجهة (UI Flow)
- شاشة التحميل → شاشة القرارات (فقط الصفوف الغامضة) → شاشة عرض الخطاب/الطباعة.

## التخزين
- LocalStorage كمصدر رئيسي للقواميس التعلمية.
- ملفات JSON للتصدير/الاستيراد لضمان النسخ الاحتياطي والتنقل بين الأجهزة.

## اعتماديات
- SheetJS لقراءة Excel.
- متصفح حديث (Chrome/Edge) للطباعة إلى PDF.
