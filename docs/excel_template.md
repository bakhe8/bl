# وثيقة قالب Excel الرسمي

النظام لا يفترض أسماء أعمدة ثابتة، لكنه يفترض وجود الحقول المنطقية التالية لكل صف، ويتم ربطها يدوياً في أول استخدام عبر شاشة الـ mapping. أي ملف لا يمكن ربط أعمدته بهذه الحقول يُرفض بوضوح.

| الحقل المنطقي        | أمثلة أسماء الأعمدة المحتملة                            | إلزامي؟ | نوع البيانات        |
|-----------------------|---------------------------------------------------------|---------|----------------------|
| bank_raw              | Bank, Bank Name, اسم البنك                              | نعم     | نص                   |
| supplier_raw          | Supplier, Vendor, اسم المورد                            | نعم     | نص                   |
| guarantee_no          | Guarantee No, رقم الضمان                                | نعم     | نص/رقم               |
| contract_no           | Contract No, رقم العقد                                  | نعم     | نص                   |
| amount_raw            | Amount, المبلغ                                          | نعم     | رقم/نص               |
| renewal_date_raw      | Expiry Date, Renewal Date, تاريخ الانتهاء               | نعم     | تاريخ                |

قاعدة رفض: عند عدم القدرة على تعيين كل الحقول الإلزامية للملف، يعرض النظام سبب الرفض ويطلب ملفاً متوافقاً أو تعييناً يدوياً ناجحاً.

## أمثلة لقيم مشبوهة وسلوك النظام
- مبلغ غير صالح: `"700,000xx"` → تحذير/رفض السطر حتى يتم التصحيح.
- تاريخ غير قابل للقراءة: `"2025-13-99"` → تحذير وإبراز السطر للمراجعة أو الاستبعاد.
- مورد يحتوي رموز غير متوقعة: `"Comp@ny###"` → إبراز السطر للمراجعة وتطبيع محدود، ولا يُقبل كاسم جديد تلقائياً.
