# وثيقة متطلبات النظام (SRS) — أولوية 5/5

## ما يجب أن يفعله النظام
- رفع ملف Excel واحد يحتوي بيانات الضمانات (حتى 100 صف).
- اكتشاف الأعمدة وتحويلها إلى JSON داخلي موحّد.
- تحليل أسماء البنوك والموردين وتطابقها آلياً مع القواميس الرسمية والبديلة.
- عرض شاشة قرارات للحالات غير المحسومة فقط.
- إنشاء خطاب تمديد رسمي بالعربية وجاهز للطباعة/الحفظ PDF.
- حفظ قرارات المستخدم كـ variants لاستخدامها تلقائياً لاحقاً.

## القيود (Constraints)
- لغة الإخراج عربية فقط مع دعم RTL.
- الاعتماد بالكامل على المتصفح (Client-only) دون خادم أو تثبيت.
- عدم تخزين بيانات حساسة خارج جهاز المستخدم.
- العمل أوفلاين، والاعتمادات الخارجية محدودة بـ SheetJS.
- صيغ الملفات المسموحة: `.xlsx` فقط. رفض `.xls`, `.xlsm`, `.csv`, والملفات الماكرو أو غير القياسية.
- حجم الملف الأقصى المقترح: 1MB (يكفي ~1000 صف)؛ عند تجاوزه يُعرض تحذير.

## متطلبات المستخدم
- رفع ملف Excel.
- مراجعة الصفوف غير المفهومة فقط.
- اختيار البنك/المورد الصحيح عند الحاجة.
- عرض الخطاب ثم طباعته.

## متطلبات الأداء
- دعم حتى 100 صف في الملف كحد تشغيلي أولي.
- سرعة معالجة تحت 1 ثانية لملف 100 صف على جهاز مكتبي (i5، 8GB RAM) في Chrome/Edge أحدث إصدار.
- تطابق آلي لـ 90% من الصفوف بدون تدخل.
- حفظ أي قرار للاستخدام المستقبلي.

## متطلبات الدقة
- عدم الاعتماد على خوارزميات ذكاء اصطناعي خطيرة أو تخمين غير موثوق.
- عدم تعديل الصفوف الغامضة بدون إذن المستخدم.
- عرض تنبيهات واضحة عند نقص الأعمدة أو عدم صلاحية القيم.
- عدم تحميل كامل Excel في DOM؛ استخدام قراءة ArrayBuffer عبر SheetJS فقط لتقليل الذاكرة.

## حالات الاستخدام (Use Cases) – أمثلة
- UC01: رفع ملف Excel.
- UC02: اكتشاف الأعمدة وتطبيق column mapping.
- UC03: معالجة الصفوف وتحويلها إلى JSON.
- UC04: مطابقة بنك ومورد (رسمي، variant، إنجليزي).
- UC05: إنشاء خطاب رسمي وتنسيقه للطباعة.

## نطاق العمل
- إصدار خطابات تمديد الضمانات البنكية استناداً إلى ملفات Excel.
- إدارة القواميس وتعلم الصيغ المختلفة للأسماء.
- لا يشمل تكاملات خارجية أو قواعد بيانات مركزية في هذه المرحلة.
- حدود عدم التنفيذ (Out of Scope حالياً):
  - عدم إرسال بريد إلكتروني أو توقيع إلكتروني.
  - لا أرشفة طويلة الأجل للخطابات داخل النظام.
  - لا تحويل مبالغ إلى نص عربي.
  - لا تحسين خاص للجوال؛ التصميم يستهدف المتصفح على سطح المكتب.
